<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Set up your creator profile on NUBEAUX Travel.">

  <title>Set Up Your Profile | NUBEAUX Travel</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Playfair+Display:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css?v=22">

  <style>
    body {
      background: var(--color-ecru);
      min-height: 100vh;
    }

    .onboarding-header {
      padding: var(--space-md) var(--space-lg);
      background: var(--color-white);
      border-bottom: 1px solid var(--color-light-grey);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .onboarding-header .logo img {
      height: 20px;
    }

    .progress-indicator {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .progress-step {
      width: 32px;
      height: 4px;
      background: var(--color-light-grey);
      border-radius: 2px;
      transition: background 0.3s ease;
    }

    .progress-step.active {
      background: var(--color-terracotta);
    }

    .progress-step.completed {
      background: var(--color-charcoal);
    }

    .onboarding-container {
      max-width: 560px;
      margin: 0 auto;
      padding: var(--space-xl);
    }

    .onboarding-step {
      display: none;
      animation: fadeInUp 0.4s ease forwards;
    }

    .onboarding-step.active {
      display: block;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .step-header {
      text-align: center;
      margin-bottom: var(--space-xl);
    }

    .step-header h1 {
      font-size: 1.75rem;
      margin-bottom: var(--space-sm);
    }

    .step-header p {
      color: var(--color-warm-grey);
      font-size: 0.9375rem;
    }

    /* Form card */
    .form-card {
      background: var(--color-white);
      padding: var(--space-lg);
      margin-bottom: var(--space-lg);
    }

    .form-card .form-group {
      margin-bottom: var(--space-md);
    }

    .form-card .form-group:last-child {
      margin-bottom: 0;
    }

    /* Region selection */
    .region-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-sm);
    }

    .region-option {
      position: relative;
    }

    .region-option input {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }

    .region-option label {
      display: block;
      padding: var(--space-sm) var(--space-md);
      background: var(--color-ecru);
      border: 1px solid var(--color-light-grey);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .region-option input:checked + label {
      background: var(--color-charcoal);
      color: var(--color-white);
      border-color: var(--color-charcoal);
    }

    .region-option label:hover {
      border-color: var(--color-charcoal);
    }

    .region-option input:focus + label {
      outline: 2px solid var(--color-terracotta);
      outline-offset: 2px;
    }

    /* Choice cards */
    .choice-grid {
      display: grid;
      gap: var(--space-md);
    }

    .choice-card {
      background: var(--color-white);
      padding: var(--space-lg);
      border: 2px solid var(--color-light-grey);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .choice-card:hover {
      border-color: var(--color-charcoal);
    }

    .choice-card.selected {
      border-color: var(--color-terracotta);
      background: #fff9f7;
    }

    .choice-card-header {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      margin-bottom: var(--space-sm);
    }

    .choice-card-icon {
      width: 48px;
      height: 48px;
      background: var(--color-ecru);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .choice-card-icon svg {
      width: 24px;
      height: 24px;
      color: var(--color-charcoal);
    }

    .choice-card.selected .choice-card-icon {
      background: var(--color-terracotta);
    }

    .choice-card.selected .choice-card-icon svg {
      color: white;
    }

    .choice-card h3 {
      font-size: 1.125rem;
      margin-bottom: 0.25rem;
    }

    .choice-card-badge {
      font-size: 0.6875rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--color-terracotta);
      background: #fff9f7;
      padding: 0.25rem 0.5rem;
      display: inline-block;
    }

    .choice-card p {
      color: var(--color-warm-grey);
      font-size: 0.875rem;
      line-height: 1.6;
    }

    /* Instagram import panel */
    .import-panel {
      display: none;
      margin-top: var(--space-lg);
      animation: fadeInUp 0.3s ease forwards;
    }

    .import-panel.visible {
      display: block;
    }

    .import-panel-content {
      background: var(--color-white);
      padding: var(--space-lg);
    }

    .import-panel h4 {
      font-size: 1rem;
      margin-bottom: var(--space-md);
    }

    .import-panel p {
      font-size: 0.875rem;
      color: var(--color-warm-grey);
      margin-bottom: var(--space-md);
    }

    .instagram-input {
      display: flex;
      gap: var(--space-sm);
    }

    .instagram-input .form-input {
      flex: 1;
    }

    .instagram-input .btn {
      flex-shrink: 0;
    }

    .link-list {
      margin-top: var(--space-md);
    }

    .link-item {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm);
      background: var(--color-ecru);
      margin-bottom: var(--space-xs);
      font-size: 0.875rem;
    }

    .link-item span {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .link-item button {
      background: none;
      border: none;
      color: var(--color-warm-grey);
      cursor: pointer;
      padding: 0;
    }

    .link-item button:hover {
      color: #dc3545;
    }

    /* Buttons */
    .step-buttons {
      display: flex;
      gap: var(--space-md);
      margin-top: var(--space-lg);
    }

    .step-buttons .btn {
      flex: 1;
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--color-light-grey);
      color: var(--color-charcoal);
    }

    .btn-secondary:hover {
      background: var(--color-ecru);
      border-color: var(--color-charcoal);
    }

    /* Skip link */
    .skip-link {
      display: block;
      text-align: center;
      margin-top: var(--space-md);
      font-size: 0.875rem;
      color: var(--color-warm-grey);
    }

    .skip-link:hover {
      color: var(--color-charcoal);
    }

    /* Loading state */
    .btn.loading {
      position: relative;
      color: transparent;
      pointer-events: none;
    }

    .btn.loading::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      top: 50%;
      left: 50%;
      margin-top: -10px;
      margin-left: -10px;
    }

    .btn-dark.loading::after {
      border-top-color: white;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Mobile */
    @media (max-width: 768px) {
      .onboarding-container {
        padding: var(--space-lg);
      }

      .step-header h1 {
        font-size: 1.5rem;
      }

      .region-grid {
        grid-template-columns: 1fr;
      }

      .step-buttons {
        flex-direction: column;
      }

      .instagram-input {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header class="onboarding-header">
    <a href="../index.html" class="logo">
      <img src="../assets/logo.svg" alt="NUBEAUX">
    </a>
    <div class="progress-indicator">
      <div class="progress-step active" id="progress1"></div>
      <div class="progress-step" id="progress2"></div>
    </div>
  </header>

  <main class="onboarding-container">
    <!-- Step 1: Profile -->
    <div class="onboarding-step active" id="step1">
      <div class="step-header">
        <h1>Tell us about yourself</h1>
        <p>This helps travellers find and trust your itineraries.</p>
      </div>

      <form class="form-card" id="profileForm">
        <div class="form-group">
          <label class="form-label" for="displayName">Display name</label>
          <input type="text" id="displayName" name="displayName" class="form-input" placeholder="How you want to appear" required>
        </div>

        <div class="form-group">
          <label class="form-label" for="instagramHandle">Instagram handle (optional)</label>
          <input type="text" id="instagramHandle" name="instagramHandle" class="form-input" placeholder="@yourhandle">
          <p style="font-size: 0.75rem; color: var(--color-warm-grey); margin-top: 0.25rem;">We will display this on your profile.</p>
        </div>

        <div class="form-group">
          <label class="form-label">Where do you travel?</label>
          <p style="font-size: 0.8125rem; color: var(--color-warm-grey); margin-bottom: var(--space-sm);">Select all that apply.</p>
          <div class="region-grid">
            <div class="region-option">
              <input type="checkbox" id="region-east-africa" name="regions" value="east-africa">
              <label for="region-east-africa">East Africa</label>
            </div>
            <div class="region-option">
              <input type="checkbox" id="region-southern-africa" name="regions" value="southern-africa">
              <label for="region-southern-africa">Southern Africa</label>
            </div>
            <div class="region-option">
              <input type="checkbox" id="region-west-africa" name="regions" value="west-africa">
              <label for="region-west-africa">West Africa</label>
            </div>
            <div class="region-option">
              <input type="checkbox" id="region-north-africa" name="regions" value="north-africa">
              <label for="region-north-africa">North Africa</label>
            </div>
            <div class="region-option">
              <input type="checkbox" id="region-caribbean" name="regions" value="caribbean">
              <label for="region-caribbean">Caribbean</label>
            </div>
            <div class="region-option">
              <input type="checkbox" id="region-other" name="regions" value="other">
              <label for="region-other">Other</label>
            </div>
          </div>
        </div>
      </form>

      <div class="step-buttons">
        <button type="button" class="btn btn-dark" id="step1Next">Continue</button>
      </div>
    </div>

    <!-- Step 2: Setup Choice -->
    <div class="onboarding-step" id="step2">
      <div class="step-header">
        <h1>How do you want to start?</h1>
        <p>Choose the fastest way to create your first itinerary.</p>
      </div>

      <div class="choice-grid">
        <div class="choice-card" data-choice="import">
          <div class="choice-card-header">
            <div class="choice-card-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
              </svg>
            </div>
            <div>
              <h3>Import from Instagram</h3>
              <span class="choice-card-badge">Fastest</span>
            </div>
          </div>
          <p>Paste links to posts, reels, or highlights. We will extract the details and build your itinerary.</p>
        </div>

        <div class="choice-card" data-choice="manual">
          <div class="choice-card-header">
            <div class="choice-card-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
              </svg>
            </div>
            <div>
              <h3>Start manually</h3>
            </div>
          </div>
          <p>Tell us about your trip and upload photos. Great if you want full control over the details.</p>
        </div>
      </div>

      <!-- Import panel -->
      <div class="import-panel" id="importPanel">
        <div class="import-panel-content">
          <h4>Add Instagram links</h4>
          <p>Paste links to posts, reels, or highlights from your trip. We will use these to build your itinerary.</p>

          <div class="instagram-input">
            <input type="text" id="instagramLink" class="form-input" placeholder="https://instagram.com/p/...">
            <button type="button" class="btn btn-dark" id="addLinkBtn">Add</button>
          </div>

          <div class="link-list" id="linkList">
            <!-- Links will be added here -->
          </div>
        </div>
      </div>

      <div class="step-buttons">
        <button type="button" class="btn btn-secondary" id="step2Back">Back</button>
        <button type="button" class="btn btn-dark" id="step2Next">Continue</button>
      </div>

      <a href="create.html" class="skip-link">Skip and start from scratch</a>
    </div>
  </main>

  <script>
    // State
    let currentStep = 1;
    let selectedChoice = null;
    let importedLinks = [];

    // Elements
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const progress1 = document.getElementById('progress1');
    const progress2 = document.getElementById('progress2');
    const importPanel = document.getElementById('importPanel');
    const linkList = document.getElementById('linkList');

    // Navigation
    function goToStep(step) {
      currentStep = step;

      // Update progress
      progress1.className = step >= 1 ? 'progress-step active' : 'progress-step';
      progress2.className = step >= 2 ? 'progress-step active' : 'progress-step';
      if (step > 1) progress1.classList.add('completed');

      // Show correct step
      step1.classList.toggle('active', step === 1);
      step2.classList.toggle('active', step === 2);

      // Track analytics
      if (window.gtag) {
        gtag('event', 'onboarding_step_viewed', { step: step });
      }
    }

    // Step 1 validation and next
    document.getElementById('step1Next').addEventListener('click', () => {
      const displayName = document.getElementById('displayName').value.trim();

      if (!displayName) {
        document.getElementById('displayName').classList.add('error');
        document.getElementById('displayName').focus();
        return;
      }

      // Track
      if (window.gtag) {
        gtag('event', 'onboarding_profile_completed');
      }

      goToStep(2);
    });

    // Step 2 back
    document.getElementById('step2Back').addEventListener('click', () => {
      goToStep(1);
    });

    // Choice cards
    document.querySelectorAll('.choice-card').forEach(card => {
      card.addEventListener('click', () => {
        // Update selection
        document.querySelectorAll('.choice-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        selectedChoice = card.dataset.choice;

        // Show/hide import panel
        importPanel.classList.toggle('visible', selectedChoice === 'import');

        // Track
        if (window.gtag) {
          gtag('event', 'onboarding_choice_selected', { choice: selectedChoice });
        }
      });
    });

    // Add link
    document.getElementById('addLinkBtn').addEventListener('click', addLink);
    document.getElementById('instagramLink').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') addLink();
    });

    function addLink() {
      const input = document.getElementById('instagramLink');
      const url = input.value.trim();

      if (!url || !url.includes('instagram.com')) {
        input.classList.add('error');
        return;
      }

      importedLinks.push(url);
      renderLinks();
      input.value = '';
      input.classList.remove('error');

      // Track
      if (window.gtag) {
        gtag('event', 'instagram_link_added', { count: importedLinks.length });
      }
    }

    function renderLinks() {
      linkList.innerHTML = importedLinks.map((link, i) => `
        <div class="link-item">
          <span>${link}</span>
          <button type="button" onclick="removeLink(${i})" aria-label="Remove link">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      `).join('');
    }

    window.removeLink = function(index) {
      importedLinks.splice(index, 1);
      renderLinks();
    };

    // Step 2 continue
    document.getElementById('step2Next').addEventListener('click', () => {
      const btn = document.getElementById('step2Next');

      if (!selectedChoice) {
        // If no choice, default to manual
        selectedChoice = 'manual';
      }

      btn.classList.add('loading');

      // Track
      if (window.gtag) {
        gtag('event', 'onboarding_completed', {
          choice: selectedChoice,
          links_count: importedLinks.length
        });
      }

      // Save profile data
      const profileData = {
        displayName: document.getElementById('displayName').value,
        instagramHandle: document.getElementById('instagramHandle').value,
        regions: Array.from(document.querySelectorAll('input[name="regions"]:checked')).map(cb => cb.value),
        setupChoice: selectedChoice,
        importedLinks: importedLinks
      };

      console.log('Profile data:', profileData);

      // Store in session for create page
      sessionStorage.setItem('creatorProfile', JSON.stringify(profileData));

      // Redirect to create page
      setTimeout(() => {
        window.location.href = selectedChoice === 'import' && importedLinks.length > 0
          ? 'create.html?import=true'
          : 'create.html';
      }, 500);
    });

    // Remove error state on input
    document.querySelectorAll('.form-input').forEach(input => {
      input.addEventListener('input', () => {
        input.classList.remove('error');
      });
    });

    // Track page view
    if (window.gtag) {
      gtag('event', 'page_view', { page_title: 'Creator Onboarding' });
    }
  </script>
</body>
</html>
