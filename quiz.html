<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Take our quiz to find your perfect destination. Answer a few questions and we'll match you with curated travel experiences.">

  <title>Discover Your Travel Personality | JUNO Travel</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Playfair+Display:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css?v=26">

  <style>
    .quiz-page {
      margin-top: var(--header-height);
      display: flex;
      flex-direction: column;
    }

    .quiz-hero {
      background-color: var(--color-warm-cream);
      padding: var(--space-lg) var(--space-md);
      text-align: center;
    }

    .quiz-hero h1 {
      margin-bottom: var(--space-sm);
    }

    .quiz-hero p {
      max-width: 500px;
      margin: 0 auto;
    }

    .quiz-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 800px;
      margin: 0 auto;
      padding: var(--space-xl) var(--space-md);
      width: 100%;
    }

    /* Progress Bar */
    .quiz-progress {
      margin-bottom: var(--space-lg);
    }

    .quiz-progress-bar {
      height: 3px;
      background-color: var(--color-light-grey);
      border-radius: 2px;
      overflow: hidden;
    }

    .quiz-progress-fill {
      height: 100%;
      background-color: var(--color-accent);
      transition: width 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .quiz-progress-text {
      font-size: 0.75rem;
      color: var(--color-text-light);
      margin-top: var(--space-xs);
      text-align: right;
    }

    /* Question */
    .quiz-question {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .quiz-question.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .quiz-question h2 {
      font-size: clamp(1.5rem, 4vw, 2.25rem);
      margin-bottom: var(--space-lg);
      text-align: center;
    }

    /* Options */
    .quiz-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-md);
    }

    .quiz-option {
      position: relative;
      cursor: pointer;
      border: 2px solid var(--color-light-grey);
      padding: var(--space-lg);
      text-align: center;
      transition: all var(--transition-fast);
      background-color: var(--color-white);
    }

    .quiz-option:hover {
      border-color: var(--color-accent);
      transform: translateY(-4px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }

    .quiz-option.selected {
      border-color: var(--color-accent);
      background-color: var(--color-warm-cream);
    }

    .quiz-option-icon {
      font-size: 2.5rem;
      margin-bottom: var(--space-sm);
      display: block;
    }

    .quiz-option h3 {
      font-size: 1.125rem;
      margin-bottom: var(--space-xs);
    }

    .quiz-option p {
      font-size: 0.8125rem;
      color: var(--color-text-light);
      margin: 0;
    }

    /* Image Options */
    .quiz-options.image-options {
      grid-template-columns: repeat(3, 1fr);
    }

    .quiz-option.image-option {
      padding: 0;
      overflow: hidden;
    }

    .quiz-option.image-option img {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      transition: transform var(--transition-slow);
    }

    .quiz-option.image-option:hover img {
      transform: scale(1.05);
    }

    .quiz-option.image-option .option-label {
      padding: var(--space-md);
      background-color: var(--color-white);
    }

    .quiz-option.image-option.selected .option-label {
      background-color: var(--color-warm-cream);
    }

    /* Navigation */
    .quiz-nav {
      display: flex;
      justify-content: space-between;
      margin-top: var(--space-xl);
      padding-top: var(--space-lg);
      border-top: 1px solid var(--color-light-grey);
    }

    .quiz-nav .btn {
      min-width: 140px;
    }

    .btn-back {
      background: none;
      border: none;
      color: var(--color-text-light);
      font-size: 0.8125rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color var(--transition-fast);
    }

    .btn-back:hover {
      color: var(--color-text);
    }

    .btn-back::before {
      content: '‚Üê';
    }

    /* Results */
    .quiz-results {
      display: none;
      text-align: center;
      animation: fadeIn 0.5s ease;
    }

    .quiz-results.active {
      display: block;
    }

    .quiz-results h2 {
      font-size: clamp(1.75rem, 4vw, 2.5rem);
      margin-bottom: var(--space-sm);
    }

    .quiz-results > p {
      margin-bottom: var(--space-xl);
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .result-destinations {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
    }

    .result-card {
      position: relative;
      overflow: hidden;
      aspect-ratio: 3/4;
    }

    .result-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform var(--transition-slow);
    }

    .result-card:hover img {
      transform: scale(1.05);
    }

    .result-card-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 50%);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: var(--space-lg);
      color: var(--color-white);
    }

    .result-card-match {
      font-size: 0.625rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--color-accent);
      background-color: var(--color-white);
      padding: 0.25rem 0.5rem;
      display: inline-block;
      margin-bottom: var(--space-xs);
      width: fit-content;
    }

    .result-card h3 {
      font-size: 1.5rem;
      color: var(--color-white);
    }

    .result-cta {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-md);
    }

    .result-cta p {
      font-size: 0.9375rem;
      color: var(--color-text-light);
    }

    /* Personality Result */
    .personality-result {
      background: linear-gradient(135deg, var(--color-warm-cream) 0%, #fff 100%);
      border-radius: 16px;
      padding: var(--space-xl);
      margin-bottom: var(--space-xl);
      text-align: center;
    }

    .personality-badge {
      display: inline-block;
      font-size: 0.625rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--color-accent);
      background: rgba(194, 112, 62, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      margin-bottom: var(--space-md);
    }

    .personality-icon {
      font-size: 4rem;
      display: block;
      margin-bottom: var(--space-sm);
    }

    .personality-name {
      font-size: clamp(1.75rem, 4vw, 2.5rem);
      margin-bottom: var(--space-sm);
      color: var(--color-text);
    }

    .personality-tagline {
      font-size: 1.125rem;
      color: var(--color-accent);
      font-style: italic;
      margin-bottom: var(--space-md);
    }

    .personality-description {
      max-width: 500px;
      margin: 0 auto var(--space-lg);
      line-height: 1.7;
    }

    .personality-traits {
      display: flex;
      justify-content: center;
      gap: var(--space-sm);
      flex-wrap: wrap;
    }

    .personality-trait {
      background: var(--color-white);
      border: 1px solid var(--color-light-grey);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.8125rem;
    }

    /* Share Button */
    .share-result {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-xs);
      margin-top: var(--space-lg);
      color: var(--color-text-light);
      font-size: 0.8125rem;
      cursor: pointer;
      transition: color var(--transition-fast);
    }

    .share-result:hover {
      color: var(--color-accent);
    }

    /* Recommended Itineraries */
    .recommended-section {
      margin-bottom: var(--space-xl);
    }

    .recommended-section h3 {
      font-size: 1.25rem;
      margin-bottom: var(--space-lg);
    }

    .recommended-itineraries {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-md);
    }

    .rec-card {
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      text-decoration: none;
      color: inherit;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .rec-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
    }

    .rec-card img {
      width: 100%;
      aspect-ratio: 4/3;
      object-fit: cover;
    }

    .rec-card-content {
      padding: var(--space-md);
      background: var(--color-white);
    }

    .rec-card-match {
      display: inline-block;
      font-size: 0.625rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--color-white);
      background: var(--color-accent);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      margin-bottom: var(--space-xs);
    }

    .rec-card h4 {
      font-size: 1rem;
      margin-bottom: 0.25rem;
    }

    .rec-card-meta {
      font-size: 0.75rem;
      color: var(--color-text-light);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .quiz-options {
        grid-template-columns: 1fr;
      }

      .quiz-options.image-options {
        grid-template-columns: repeat(2, 1fr);
      }

      .result-destinations {
        grid-template-columns: 1fr;
      }

      .recommended-itineraries {
        grid-template-columns: 1fr;
      }

      .personality-traits {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo"><img src="assets/logo.svg?v=2" alt="JUNO"></a>
      <nav class="nav">
        <a href="destinations/">Destinations</a>
        <a href="itineraries/">Itineraries</a>
        <a href="stays/">Stays</a>
        <a href="journal/">Journal</a>
        <a href="about.html">About</a>
        <a href="plan-your-trip.html" class="nav-cta">Plan Your Trip</a>
      </nav>
      <button class="menu-toggle" aria-label="Toggle menu"><span></span><span></span><span></span></button>
    </div>
  </header>

  <div class="mobile-menu">
    <a href="destinations/">Destinations</a>
    <a href="itineraries/">Itineraries</a>
    <a href="stays/">Stays</a>
        <a href="journal/">Journal</a>
    <a href="about.html">About</a>
    <a href="plan-your-trip.html" class="mobile-menu-cta">Plan Your Trip</a>
  </div>

  <div class="quiz-page">
    <section class="quiz-hero">
      <div class="container">
        <h1>Discover Your Travel Personality</h1>
        <p>Answer 5 quick questions and we'll reveal your travel style ‚Äî plus match you with perfect itineraries.</p>
      </div>
    </section>

    <div class="quiz-container">
      <div class="quiz-progress">
        <div class="quiz-progress-bar">
          <div class="quiz-progress-fill" id="progressFill" style="width: 20%"></div>
        </div>
        <div class="quiz-progress-text"><span id="currentQuestion">1</span> of 5</div>
      </div>

      <!-- Question 1: Travel Style -->
      <div class="quiz-question active" data-question="1">
        <h2>What kind of experience are you looking for?</h2>
        <div class="quiz-options">
          <div class="quiz-option" data-value="adventure" data-tags="safari,wildlife,nature">
            <span class="quiz-option-icon">ü¶Å</span>
            <h3>Wildlife & Safari</h3>
            <p>Get close to nature and incredible animals</p>
          </div>
          <div class="quiz-option" data-value="beach" data-tags="beach,island,relaxation">
            <span class="quiz-option-icon">üèùÔ∏è</span>
            <h3>Beach & Island</h3>
            <p>Pristine beaches and ocean vibes</p>
          </div>
          <div class="quiz-option" data-value="culture" data-tags="culture,history,heritage">
            <span class="quiz-option-icon">üèõÔ∏è</span>
            <h3>Culture & Heritage</h3>
            <p>History, art, and local traditions</p>
          </div>
          <div class="quiz-option" data-value="city" data-tags="city,urban,gastronomy">
            <span class="quiz-option-icon">üåÜ</span>
            <h3>City & Gastronomy</h3>
            <p>Urban energy and culinary experiences</p>
          </div>
        </div>
      </div>

      <!-- Question 2: Pace -->
      <div class="quiz-question" data-question="2">
        <h2>What's your ideal travel pace?</h2>
        <div class="quiz-options">
          <div class="quiz-option" data-value="slow" data-tags="relaxation,wellness">
            <span class="quiz-option-icon">üßò</span>
            <h3>Slow & Relaxed</h3>
            <p>Unwind with plenty of downtime</p>
          </div>
          <div class="quiz-option" data-value="balanced" data-tags="balanced">
            <span class="quiz-option-icon">‚öñÔ∏è</span>
            <h3>Balanced Mix</h3>
            <p>Activity and relaxation in equal measure</p>
          </div>
          <div class="quiz-option" data-value="active" data-tags="adventure,active">
            <span class="quiz-option-icon">ü•æ</span>
            <h3>Active & Adventurous</h3>
            <p>Packed itinerary, maximum experiences</p>
          </div>
          <div class="quiz-option" data-value="flexible" data-tags="flexible">
            <span class="quiz-option-icon">üåä</span>
            <h3>Go With The Flow</h3>
            <p>Spontaneous and flexible schedule</p>
          </div>
        </div>
      </div>

      <!-- Question 3: Landscape -->
      <div class="quiz-question" data-question="3">
        <h2>Which landscape speaks to you?</h2>
        <div class="quiz-options image-options">
          <div class="quiz-option image-option" data-value="savanna" data-tags="namibia,kenya,south-africa">
            <img src="https://res.cloudinary.com/dng12bd0a/image/upload/c_fill,w_400,h_400,q_auto,f_auto/v1769677162/Namibia_onguma_Klein-38_eg57nf.jpg" alt="African savanna">
            <div class="option-label">
              <h3>Open Savanna</h3>
            </div>
          </div>
          <div class="quiz-option image-option" data-value="ocean" data-tags="zanzibar,mozambique,lamu,kilifi">
            <img src="https://images.unsplash.com/photo-1590523277543-a94d2e4eb00b?w=400&h=400&fit=crop&q=80" alt="Tropical ocean">
            <div class="option-label">
              <h3>Tropical Coast</h3>
            </div>
          </div>
          <div class="quiz-option image-option" data-value="mountains" data-tags="rwanda,south-africa">
            <img src="https://images.unsplash.com/photo-1504526966975-1c25f6ca3aec?w=400&h=400&fit=crop&q=80" alt="Mountains and hills">
            <div class="option-label">
              <h3>Mountains & Hills</h3>
            </div>
          </div>
        </div>
      </div>

      <!-- Question 4: Travel Party -->
      <div class="quiz-question" data-question="4">
        <h2>Who are you traveling with?</h2>
        <div class="quiz-options">
          <div class="quiz-option" data-value="solo" data-tags="solo">
            <span class="quiz-option-icon">üß≥</span>
            <h3>Solo</h3>
            <p>Just me, myself, and I</p>
          </div>
          <div class="quiz-option" data-value="couple" data-tags="romantic,couples">
            <span class="quiz-option-icon">üíë</span>
            <h3>Partner</h3>
            <p>Romantic getaway for two</p>
          </div>
          <div class="quiz-option" data-value="friends" data-tags="group,friends">
            <span class="quiz-option-icon">üëØ</span>
            <h3>Friends</h3>
            <p>Adventure with my crew</p>
          </div>
          <div class="quiz-option" data-value="family" data-tags="family">
            <span class="quiz-option-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
            <h3>Family</h3>
            <p>Multi-generational travel</p>
          </div>
        </div>
      </div>

      <!-- Question 5: Priority -->
      <div class="quiz-question" data-question="5">
        <h2>What matters most to you?</h2>
        <div class="quiz-options">
          <div class="quiz-option" data-value="luxury" data-tags="luxury,premium">
            <span class="quiz-option-icon">‚ú®</span>
            <h3>Luxury & Comfort</h3>
            <p>Five-star service and amenities</p>
          </div>
          <div class="quiz-option" data-value="authentic" data-tags="authentic,local">
            <span class="quiz-option-icon">üè∫</span>
            <h3>Authenticity</h3>
            <p>Real local experiences</p>
          </div>
          <div class="quiz-option" data-value="unique" data-tags="unique,off-beaten-path">
            <span class="quiz-option-icon">üó∫Ô∏è</span>
            <h3>Unique & Rare</h3>
            <p>Off-the-beaten-path discoveries</p>
          </div>
          <div class="quiz-option" data-value="photography" data-tags="photography,scenic">
            <span class="quiz-option-icon">üì∏</span>
            <h3>Photo Opportunities</h3>
            <p>Stunning visuals at every turn</p>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div class="quiz-results" id="quizResults">
        <!-- Personality Reveal -->
        <div class="personality-result" id="personalityResult">
          <span class="personality-badge">Your Travel Personality</span>
          <span class="personality-icon" id="personalityIcon"></span>
          <h2 class="personality-name" id="personalityName"></h2>
          <p class="personality-tagline" id="personalityTagline"></p>
          <p class="personality-description" id="personalityDescription"></p>
          <div class="personality-traits" id="personalityTraits"></div>
          <div class="share-result" onclick="shareResult()">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 12v3h12v-3M10 3v9M6 7l4-4 4 4"/>
            </svg>
            Share your result
          </div>
        </div>

        <!-- Recommended Itineraries -->
        <div class="recommended-section">
          <h3>Itineraries Made For You</h3>
          <div class="recommended-itineraries" id="recommendedItineraries">
            <!-- Populated by JS -->
          </div>
        </div>

        <!-- Top Destinations -->
        <div class="recommended-section">
          <h3>Destinations You'll Love</h3>
          <div class="result-destinations" id="resultDestinations">
            <!-- Results populated by JS -->
          </div>
        </div>

        <div class="result-cta">
          <p>Ready to start planning?</p>
          <a href="plan-your-trip.html" class="btn btn-primary">Plan Your Trip</a>
          <button class="btn-back" onclick="restartQuiz()">Take Quiz Again</button>
        </div>
      </div>

      <!-- Navigation -->
      <div class="quiz-nav" id="quizNav">
        <button class="btn-back" id="btnBack" style="visibility: hidden;">Back</button>
        <button class="btn btn-primary" id="btnNext" disabled>Next</button>
      </div>
    </div>
  </div>

  <script src="js/main.js?v=2"></script>
  <script>
    // Travel Personality Types
    const personalities = {
      explorer: {
        icon: 'üß≠',
        name: 'The Explorer',
        tagline: '"The world is a book, and I intend to read every page."',
        description: 'You crave discovery and adventure. Whether it\'s trekking through remote landscapes or uncovering hidden gems, you\'re always seeking the path less traveled. Comfort zones are for other people.',
        traits: ['Adventurous', 'Curious', 'Independent', 'Thrill-seeker'],
        triggers: ['adventure', 'active', 'unique', 'off-beaten-path', 'solo', 'savanna', 'mountains']
      },
      connoisseur: {
        icon: '‚ú®',
        name: 'The Connoisseur',
        tagline: '"Life is too short for ordinary experiences."',
        description: 'You appreciate the finer things in travel. From world-class cuisine to five-star lodges, you believe luxury enhances every journey. Quality over quantity, always.',
        traits: ['Refined', 'Discerning', 'Sophisticated', 'Quality-focused'],
        triggers: ['luxury', 'premium', 'gastronomy', 'city', 'urban', 'couples', 'romantic']
      },
      storyteller: {
        icon: 'üìñ',
        name: 'The Storyteller',
        tagline: '"Every destination has a story waiting to be told."',
        description: 'You travel for the stories ‚Äî the history, the culture, the people you meet. You\'d rather spend an afternoon at a local market than a museum, soaking in authentic experiences.',
        traits: ['Cultural', 'Authentic', 'Thoughtful', 'Connection-seeker'],
        triggers: ['culture', 'history', 'heritage', 'authentic', 'local', 'photography']
      },
      wanderer: {
        icon: 'üåä',
        name: 'The Wanderer',
        tagline: '"Not all who wander are lost ‚Äî some are finding themselves."',
        description: 'You travel to disconnect and recharge. Beach days, sunset cocktails, and no alarm clocks. Your ideal trip is flexible, relaxed, and entirely on your terms.',
        traits: ['Relaxed', 'Present', 'Mindful', 'Easy-going'],
        triggers: ['beach', 'island', 'relaxation', 'wellness', 'slow', 'flexible', 'ocean']
      },
      connector: {
        icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
        name: 'The Connector',
        tagline: '"The best journeys are shared with the ones you love."',
        description: 'Travel for you is about togetherness ‚Äî creating memories with family, friends, or that special someone. The destination matters, but the company matters more.',
        traits: ['Family-oriented', 'Social', 'Memory-maker', 'Inclusive'],
        triggers: ['family', 'friends', 'group', 'balanced', 'safari', 'wildlife']
      }
    };

    // Destinations data
    const destinations = {
      namibia: {
        name: 'Namibia',
        image: 'https://res.cloudinary.com/dng12bd0a/image/upload/c_fill,w_500,h_650,q_auto,f_auto/v1769677162/Namibia_onguma_Klein-38_eg57nf.jpg',
        url: 'destinations/namibia.html',
        tags: ['safari', 'wildlife', 'nature', 'adventure', 'photography', 'scenic', 'luxury', 'couples', 'unique']
      },
      kenya: {
        name: 'Kenya',
        image: 'https://images.unsplash.com/photo-1547970810-dc1eac37d174?w=500&h=650&fit=crop&q=80',
        url: 'destinations/kenya.html',
        tags: ['safari', 'wildlife', 'culture', 'beach', 'active', 'family', 'authentic', 'photography']
      },
      zanzibar: {
        name: 'Zanzibar',
        image: 'https://images.unsplash.com/photo-1586861203927-800a5acdcc4d?w=500&h=650&fit=crop&q=80',
        url: 'destinations/zanzibar.html',
        tags: ['beach', 'island', 'relaxation', 'culture', 'romantic', 'couples', 'history', 'wellness']
      },
      mozambique: {
        name: 'Mozambique',
        image: 'https://images.unsplash.com/photo-1590523277543-a94d2e4eb00b?w=500&h=650&fit=crop&q=80',
        url: 'destinations/mozambique.html',
        tags: ['beach', 'island', 'relaxation', 'unique', 'off-beaten-path', 'luxury', 'couples', 'diving']
      },
      'south-africa': {
        name: 'South Africa',
        image: 'https://images.unsplash.com/photo-1580060839134-75a5edca2e99?w=500&h=650&fit=crop&q=80',
        url: 'destinations/south-africa.html',
        tags: ['city', 'urban', 'gastronomy', 'safari', 'culture', 'balanced', 'friends', 'family', 'photography']
      },
      senegal: {
        name: 'Senegal',
        image: 'https://images.unsplash.com/photo-1591122947157-26bad3a117d2?w=500&h=650&fit=crop&q=80',
        url: 'destinations/senegal.html',
        tags: ['culture', 'history', 'heritage', 'authentic', 'local', 'city', 'friends', 'solo']
      },
    };

    let currentQuestion = 1;
    let totalQuestions = 5;
    let selectedTags = [];
    let selectedValues = [];

    const questions = document.querySelectorAll('.quiz-question');
    const progressFill = document.getElementById('progressFill');
    const currentQuestionText = document.getElementById('currentQuestion');
    const btnBack = document.getElementById('btnBack');
    const btnNext = document.getElementById('btnNext');
    const quizNav = document.getElementById('quizNav');
    const quizResults = document.getElementById('quizResults');

    // Option selection
    document.querySelectorAll('.quiz-option').forEach(option => {
      option.addEventListener('click', function() {
        const parent = this.closest('.quiz-options');
        parent.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
        this.classList.add('selected');
        btnNext.disabled = false;

        // Store selected tags and values
        const tags = this.dataset.tags.split(',');
        const value = this.dataset.value;
        const questionNum = parseInt(this.closest('.quiz-question').dataset.question);

        selectedTags[questionNum - 1] = tags;
        selectedValues[questionNum - 1] = value;
      });
    });

    // Next button
    btnNext.addEventListener('click', function() {
      if (currentQuestion < totalQuestions) {
        questions[currentQuestion - 1].classList.remove('active');
        currentQuestion++;
        questions[currentQuestion - 1].classList.add('active');

        updateProgress();
        btnBack.style.visibility = 'visible';
        btnNext.disabled = true;

        const currentQ = questions[currentQuestion - 1];
        if (currentQ.querySelector('.quiz-option.selected')) {
          btnNext.disabled = false;
        }

        if (currentQuestion === totalQuestions) {
          btnNext.textContent = 'Reveal My Personality';
        }
      } else {
        showResults();
      }
    });

    // Back button
    btnBack.addEventListener('click', function() {
      if (currentQuestion > 1) {
        questions[currentQuestion - 1].classList.remove('active');
        currentQuestion--;
        questions[currentQuestion - 1].classList.add('active');

        updateProgress();
        btnNext.textContent = 'Next';
        btnNext.disabled = false;

        if (currentQuestion === 1) {
          btnBack.style.visibility = 'hidden';
        }
      }
    });

    function updateProgress() {
      const progress = (currentQuestion / totalQuestions) * 100;
      progressFill.style.width = progress + '%';
      currentQuestionText.textContent = currentQuestion;
    }

    function calculatePersonality(allTags) {
      const scores = {};

      Object.keys(personalities).forEach(key => {
        const p = personalities[key];
        let score = 0;
        allTags.forEach(tag => {
          if (p.triggers.includes(tag)) score++;
        });
        scores[key] = score;
      });

      // Get highest scoring personality
      const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
      return personalities[sorted[0][0]];
    }

    async function fetchRecommendedItineraries(allTags) {
      try {
        // Try to fetch from API
        const response = await fetch('/.netlify/functions/get-itineraries?limit=6');
        if (response.ok) {
          const data = await response.json();
          if (data.itineraries && data.itineraries.length > 0) {
            // Score itineraries based on tags
            const scored = data.itineraries.map(it => {
              let score = 0;
              const itTags = (it.tags || []).map(t => t.toLowerCase());
              const itDest = (it.destination || '').toLowerCase();

              allTags.forEach(tag => {
                if (itTags.includes(tag)) score += 2;
                if (itDest.includes(tag)) score += 1;
              });

              return { ...it, matchScore: score };
            });

            return scored.sort((a, b) => b.matchScore - a.matchScore).slice(0, 3);
          }
        }
      } catch (e) {
        console.log('Could not fetch itineraries:', e);
      }
      return null;
    }

    async function showResults() {
      // Hide questions and nav
      questions.forEach(q => q.classList.remove('active'));
      quizNav.style.display = 'none';
      document.querySelector('.quiz-progress').style.display = 'none';

      const allTags = selectedTags.flat();

      // Calculate personality
      const personality = calculatePersonality(allTags);

      // Save to localStorage for personalization
      localStorage.setItem('juno_travel_personality', JSON.stringify({
        type: personality.name,
        tags: allTags,
        timestamp: new Date().toISOString()
      }));

      // Display personality
      document.getElementById('personalityIcon').textContent = personality.icon;
      document.getElementById('personalityName').textContent = personality.name;
      document.getElementById('personalityTagline').textContent = personality.tagline;
      document.getElementById('personalityDescription').textContent = personality.description;

      const traitsContainer = document.getElementById('personalityTraits');
      traitsContainer.innerHTML = personality.traits
        .map(t => `<span class="personality-trait">${t}</span>`)
        .join('');

      // Fetch and display recommended itineraries
      const itineraries = await fetchRecommendedItineraries(allTags);
      const itContainer = document.getElementById('recommendedItineraries');

      if (itineraries && itineraries.length > 0) {
        itContainer.innerHTML = itineraries.map(it => `
          <a href="itineraries/${it.slug || it.id}.html" class="rec-card">
            <img src="${it.hero_image || 'https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=600&h=450&fit=crop'}" alt="${it.title}">
            <div class="rec-card-content">
              <span class="rec-card-match">Perfect Match</span>
              <h4>${it.title}</h4>
              <p class="rec-card-meta">${it.destination} ¬∑ ${it.duration}</p>
            </div>
          </a>
        `).join('');
      } else {
        // Fallback if no itineraries from API
        itContainer.innerHTML = `
          <a href="itineraries/" class="rec-card">
            <img src="https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=600&h=450&fit=crop" alt="Browse itineraries">
            <div class="rec-card-content">
              <span class="rec-card-match">Explore</span>
              <h4>Browse All Itineraries</h4>
              <p class="rec-card-meta">Find your perfect trip</p>
            </div>
          </a>
        `;
      }

      // Calculate destination scores
      const destScores = {};
      Object.keys(destinations).forEach(key => {
        const dest = destinations[key];
        let score = 0;
        allTags.forEach(tag => {
          if (dest.tags.includes(tag)) score++;
        });
        destScores[key] = score;
      });

      // Sort and get top 3
      const sorted = Object.entries(destScores)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3);

      // Display destinations
      const resultsContainer = document.getElementById('resultDestinations');
      resultsContainer.innerHTML = sorted.map((item, index) => {
        const [key, score] = item;
        const dest = destinations[key];
        const matchPercent = Math.min(Math.round((score / allTags.length) * 100) + 60, 98);

        return `
          <a href="${dest.url}" class="result-card">
            <img src="${dest.image}" alt="${dest.name}">
            <div class="result-card-overlay">
              <span class="result-card-match">${matchPercent}% Match</span>
              <h3>${dest.name}</h3>
            </div>
          </a>
        `;
      }).join('');

      quizResults.classList.add('active');

      // Scroll to results
      quizResults.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function shareResult() {
      const personality = document.getElementById('personalityName').textContent;
      const text = `I'm ${personality}! Take the JUNO Travel personality quiz to discover yours.`;
      const url = window.location.href;

      if (navigator.share) {
        navigator.share({ title: 'My Travel Personality', text, url });
      } else {
        // Copy to clipboard
        navigator.clipboard.writeText(`${text} ${url}`).then(() => {
          const btn = document.querySelector('.share-result');
          btn.innerHTML = '<svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 13l4-4-4-4"/></svg> Copied!';
          setTimeout(() => {
            btn.innerHTML = '<svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12v3h12v-3M10 3v9M6 7l4-4 4 4"/></svg> Share your result';
          }, 2000);
        });
      }
    }

    function restartQuiz() {
      currentQuestion = 1;
      selectedTags = [];
      selectedValues = [];

      // Reset UI
      quizResults.classList.remove('active');
      quizNav.style.display = 'flex';
      document.querySelector('.quiz-progress').style.display = 'block';

      questions.forEach((q, i) => {
        q.classList.remove('active');
        q.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
      });
      questions[0].classList.add('active');

      updateProgress();
      btnBack.style.visibility = 'hidden';
      btnNext.disabled = true;
      btnNext.textContent = 'Next';
    }
  </script>
<script src="js/voice-agent.js?v=4"></script>
</body>
</html>
